function u = tracker_control(x, r, t)
    A_ctl = [
        0,         0, 1.0,   0;
        0,         0,   0, 1.0;
        0,  -167.587,   0,   0;
        0,   574.761,   0,   0;
    ];
  
    B_ctrl = [
                0;
                0;
         2060.299;
        -4135.392;
    ];

    C = eye(4);
    
    Q = diag([1 1000 1 10]);
    R = 100000;
    [P, ~, ~] = care(A_ctl, B_ctrl, Q, R);
%     P = [
%         1.3406,    3.9893,    0.3986,    0.2062;
%         3.9893,  157.9898,    5.1417,    2.9572;
%         0.3986,    5.1417,    0.5007,    0.2597;
%         0.2062,    2.9572,    0.2597,    0.1599;
%     ];
    G = inv((B_ctrl * inv(R) * B_ctrl' * P - A_ctl)') * C' * Q;
%     G = [
%         1.3458,   -0.0000,   -1.0000,         0;
%         4.0082,    0.0000,         0,  -10.0000;
%         0.4003,   -8.4200,         0,         0;
%         0.2071,   -4.1949,         0,         0;    
%     ];
    g = G * [r(t); 0; 0; 0];
    u = -inv(R) * B_ctrl' *(P * x - g);
end